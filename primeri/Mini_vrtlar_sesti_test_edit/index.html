<html lang="sr"><head>
<meta charset="utf-8">
<title>Mini vrtlar</title>
<style>
  /* Audience: osnovna ≈°kola, biologija/botanika */
  :root{
    --bg:#f0f8ef;
    --panel:#ffffffcc;
    --accent:#6aa84f;
    --pot:#8b5a2b;
    --pot-dark:#6e4729;
    --soil:#5b3a29;
    --soil-dark:#4a2f21;
    --seed:#e0c097;
    --text:#264d21;
    --button:#ffd966;
  }
  html,body{height:100%;margin:0;font-family:Segoe UI, Roboto, Arial, sans-serif;background:linear-gradient(to bottom,#dff3e4, #f0f8ef);color:var(--text)}
  .container{max-width:1100px;margin:20px auto;padding:18px;background:var(--panel);border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.08)}
  header{display:flex;flex-direction:column;gap:8px}
  h1{margin:0;font-size:28px;color:#134e07}
  p.description{margin:0;color:#2f6f36}
  .layout{display:flex;gap:16px;margin-top:14px;align-items:flex-start}
  .left-col,.right-col{width:160px;display:flex;flex-direction:column;gap:12px;align-items:center}
  .center{flex:1;display:flex;flex-direction:column;align-items:center;gap:12px}
  .controls{display:flex;flex-direction:column;gap:10px;align-items:center}
  button.tool{
    background:linear-gradient(180deg,var(--button),#f6c95f);
    border:2px solid rgba(0,0,0,0.08);
    padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:600;
    box-shadow:0 3px 0 rgba(0,0,0,0.08);
  }
  button.tool:active{transform:translateY(2px);box-shadow:none}
  .note{background:#fff8e1;border:1px solid #ffdca1;padding:8px;border-radius:8px;font-size:13px;text-align:center}
  #messagePanel{width:100%;min-height:56px;background:rgba(255,255,255,0.9);border-radius:8px;border:1px solid #e6efe0;padding:10px;display:flex;align-items:center;justify-content:center;font-weight:600;color:#2b5f2b}
  /* SVG garden styles */
  svg{width:100%;height:420px;display:block}
  .ground{fill:linear-gradient(var(--soil),#4b2f20);opacity:0.95}
  .pot-body{fill:var(--pot);stroke:#5b3a2b;stroke-width:2}
  .pot-rim{fill:#c28b5c;opacity:0.95}
  .soil{fill:var(--soil)}
  .soil-texture{opacity:0.18}
  .seed{fill:var(--seed);stroke:#a67c52;stroke-width:1}
  .sprout{fill:none;stroke:#2d8f3a;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;transform-origin:center bottom;transform-box:fill-box;transform:scaleY(0);transition:transform 900ms cubic-bezier(.2,.9,.35,1)}
  .sprout.grow{transform:scaleY(1)}
  .leaf{fill:#2b8b3b;opacity:0;transform-origin:center;transform:scale(0.5);transition:all 700ms ease}
  .leaf.grow{opacity:1;transform:scale(1)}
  .sun { fill: #ffdd57; stroke:#f7c948; stroke-width:2 }
  .ray { fill:#ffd966; opacity:0.0; transform-origin:center; transform-box:fill-box; transition:opacity 400ms ease, transform 800ms ease; }
  .ray.show{opacity:0.9; transform:scale(1.05) rotate(0deg)}
  .droplet { fill:#7fc9ff; opacity:0.95; filter:drop-shadow(0 2px 3px rgba(0,0,0,0.15)) }
  /* flower styles */
  .flower{transform-origin:center bottom;transform-box:fill-box;transform:scale(0.0);opacity:0;transition:transform 700ms cubic-bezier(.2,.9,.35,1), opacity 500ms ease}
  .flower.open{transform:scale(1);opacity:1}
  .flower .petal{fill:#ff9ab8; transform-origin:center; transform-box:fill-box; transform:scale(0.2); transition:transform 500ms ease 120ms, fill 300ms}
  .flower.open .petal{transform:scale(1)}
  .flower .center{fill:#ffd23f; transition:transform 400ms ease}
  .flower-stem{stroke:#318b3a;stroke-width:2; stroke-linecap:round}
  /* subtle animations */
  .sun.pulse { animation: sunPulse 1.8s infinite ease-in-out; }
  @keyframes sunPulse {
    0%{transform:scale(1)}
    50%{transform:scale(1.05)}
    100%{transform:scale(1)}
  }
  /* improved pot shadow */
  .pot-shadow{filter:drop-shadow(0 6px 8px rgba(0,0,0,0.12))}
  /* decorative */
  .infoSmall{font-size:13px;color:#2f6f36;text-align:center}
  .footerNote{font-size:12px;color:#5a7a52;margin-top:8px;text-align:center}
  @media (max-width:880px){
    .layout{flex-direction:column}
    .left-col,.right-col{flex-direction:row;width:100%;justify-content:center}
    .controls{flex-direction:row;gap:10px}
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>Mini vrtlar</h1>
    <p class="description">Interaktivni alat koji omoguƒáava uƒçenicima da sade biljke, zalivaju ih i prate njihov rast u razliƒçitim uslovima svetlosti i tla.</p>
  </header>

  <div class="layout">
    <div class="left-col">
      <div class="controls">
        <button id="sunBtn" class="tool" title="Poveƒáaj svetlost">‚òÄÔ∏è Sunƒçeva svetlost</button>
        <div class="note">Pritisnite da po≈°aljete svetlost biljkama.</div>
      </div>
    </div>

    <div class="center">
      <div id="messagePanel">Biljke brzo rastu, ali previ≈°e vode mo≈æe ih o≈°tetiti.</div>

      <!-- SVG garden -->
      <svg id="garden" viewBox="0 0 1000 420" xmlns="http://www.w3.org/2000/svg" aria-label="Mini vrt">
        <!-- defs for gradients -->
        <defs>
          <linearGradient id="skyGrad" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#eafaf1"></stop>
            <stop offset="1" stop-color="#d7f1dd"></stop>
          </linearGradient>
          <linearGradient id="potGrad" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#c6864a"/>
            <stop offset="1" stop-color="#8b5a2b"/>
          </linearGradient>
          <linearGradient id="potShadow" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#7a4f2f" stop-opacity="0.6"/>
            <stop offset="1" stop-color="#5b3a29" stop-opacity="0.6"/>
          </linearGradient>
          <linearGradient id="soilGrad" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#6a3f2a"/>
            <stop offset="1" stop-color="#4b2f20"/>
          </linearGradient>
          <linearGradient id="soilTop" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#704226"/>
            <stop offset="1" stop-color="#4d2b1a"/>
          </linearGradient>
        </defs>

        <!-- sky -->
        <rect x="0" y="0" width="1000" height="420" fill="url(#skyGrad)"></rect>
        <!-- sun (left-top) -->
        <g id="sunGroup" transform="translate(70,70)" class="pulse">
          <circle id="sunCore" class="sun" cx="0" cy="0" r="28"></circle>
          <g id="rays" transform="scale(1.1)">
            <polygon class="ray" points="-6,-48 6,-48 2,-12 -2,-12"></polygon>
            <polygon class="ray" points="-41,-6 -41,6 -12,2 -12,-2"></polygon>
            <polygon class="ray" points="6,48 -6,48 -2,12 2,12"></polygon>
            <polygon class="ray" points="48,6 48,-6 12,-2 12,2"></polygon>
            <polygon class="ray" points="33,-33 41,-41 12,-12 4,-4"></polygon>
            <polygon class="ray" points="-33,33 -41,41 -12,12 -4,4"></polygon>
            <polygon class="ray" points="-33,-33 -41,-41 -12,-12 -4,-4"></polygon>
            <polygon class="ray" points="33,33 41,41 12,12 4,4"></polygon>
          </g>
        </g>

        <!-- improved ground layers -->
        <rect x="0" y="300" width="1000" height="120" fill="#caa887"></rect>
        <rect x="0" y="312" width="1000" height="108" fill="#d6e3d3"></rect>

        <g id="potsGroup">
          <!-- Pot 1 left -->
          <g class="pot" data-id="pot0" transform="translate(180,260)" style="cursor:pointer">
            <path class="pot-body pot-shadow" d="M-40,30 q0,18 10,18 h60 q10,0 10,-18 v-24 h-80 z" fill="url(#potGrad)"></path>
            <ellipse class="pot-rim" cx="20" cy="8" rx="34" ry="10" style="fill:url(#potShadow);opacity:0.9"></ellipse>
            <ellipse class="soil" cx="20" cy="8" rx="34" ry="10" style="transition: fill 600ms; fill: url(#soilGrad);"></ellipse>
            <g class="soil-texture" style="opacity:0.15" transform="translate(-8,2)">
              <circle cx="30" cy="6" r="1.8" fill="#d2a07e"></circle>
              <circle cx="10" cy="8" r="1" fill="#c28b5c"></circle>
              <circle cx="22" cy="3" r="1.2" fill="#b6794e"></circle>
            </g>
            <circle class="seed" cx="20" cy="6" r="5" id="seed0" style="transition: transform 700ms, opacity 600ms; transform: translateY(6px) scale(0.6); opacity: 0.35;"></circle>
            <!-- sprout path (hidden initially) -->
            <path class="sprout grow" id="sprout0" d="M20,14 C22,6 26,0 26,-20" style="transform: scaleY(1); transition: stroke-width 600ms; stroke-width: 5.5;"></path>
            <!-- leaves -->
            <path id="leaf0a" class="leaf grow" d="M26,-12 C36,-18 44,-10 36,-6 C30,-3 26,-6 26,-12" style="fill: rgb(47, 158, 62);"></path>
            <path id="leaf0b" class="leaf grow" d="M20,-12 C8,-18 0,-10 8,-6 C14,-3 18,-6 20,-12" style="fill: rgb(47, 158, 62);"></path>

            <!-- flower (hidden until plant reaches height) -->
            <g id="flower0" class="flower" transform="translate(26,-28)">
              <path class="flower-stem" d="M0,0 L0,12" stroke-linecap="round"></path>
              <g transform="translate(0,-2)">
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(0)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(45)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(90)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(135)"></ellipse>
                <circle class="center" cx="0" cy="0" r="4"></circle>
              </g>
            </g>
          </g>

          <!-- Pot 2 center -->
          <g class="pot" data-id="pot1" transform="translate(480,260)" style="cursor:pointer">
            <path class="pot-body pot-shadow" d="M-40,30 q0,18 10,18 h60 q10,0 10,-18 v-24 h-80 z" fill="url(#potGrad)"></path>
            <ellipse class="pot-rim" cx="20" cy="8" rx="34" ry="10" style="fill:url(#potShadow);opacity:0.9"></ellipse>
            <ellipse class="soil" cx="20" cy="8" rx="34" ry="10" style="transition: fill 600ms; fill: url(#soilGrad);"></ellipse>
            <g class="soil-texture" style="opacity:0.15" transform="translate(-8,2)">
              <circle cx="28" cy="11" r="1.6" fill="#d2a07e"></circle>
              <circle cx="16" cy="6" r="1.1" fill="#c28b5c"></circle>
              <circle cx="6" cy="9" r="1.3" fill="#b6794e"></circle>
            </g>
            <circle class="seed" cx="20" cy="6" r="5" id="seed1" style="transition: transform 700ms, opacity 600ms; transform: translateY(6px) scale(0.6); opacity: 0.35;"></circle>
            <path class="sprout grow" id="sprout1" d="M20,14 C22,6 26,0 26,-20" style="transition: stroke-width 600ms; stroke-width: 5.5; transform: scaleY(1);"></path>
            <path id="leaf1a" class="leaf grow" d="M26,-12 C36,-18 44,-10 36,-6 C30,-3 26,-6 26,-12" style="fill: rgb(47, 158, 62);"></path>
            <path id="leaf1b" class="leaf grow" d="M20,-12 C8,-18 0,-10 8,-6 C14,-3 18,-6 20,-12" style="fill: rgb(47, 158, 62);"></path>

            <g id="flower1" class="flower" transform="translate(26,-28)">
              <path class="flower-stem" d="M0,0 L0,12" stroke-linecap="round"></path>
              <g transform="translate(0,-2)">
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(0)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(45)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(90)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(135)"></ellipse>
                <circle class="center" cx="0" cy="0" r="4"></circle>
              </g>
            </g>
          </g>

          <!-- Pot 3 right -->
          <g class="pot" data-id="pot2" transform="translate(780,260)" style="cursor:pointer">
            <path class="pot-body pot-shadow" d="M-40,30 q0,18 10,18 h60 q10,0 10,-18 v-24 h-80 z" fill="url(#potGrad)"></path>
            <ellipse class="pot-rim" cx="20" cy="8" rx="34" ry="10" style="fill:url(#potShadow);opacity:0.9"></ellipse>
            <ellipse class="soil" cx="20" cy="8" rx="34" ry="10" style="transition: fill 600ms; fill: url(#soilGrad);"></ellipse>
            <g class="soil-texture" style="opacity:0.15" transform="translate(-8,2)">
              <circle cx="24" cy="7" r="1.5" fill="#d2a07e"></circle>
              <circle cx="14" cy="10" r="1" fill="#c28b5c"></circle>
              <circle cx="34" cy="9" r="1.2" fill="#b6794e"></circle>
            </g>
            <circle class="seed" cx="20" cy="6" r="5" id="seed2" style="transition: transform 700ms, opacity 600ms; transform: translateY(6px) scale(0.6); opacity: 0.35;"></circle>
            <path class="sprout grow" id="sprout2" d="M20,14 C22,6 26,0 26,-20" style="stroke-width: 5.5; transform: scaleY(1); transition: stroke-width 600ms;"></path>
            <path id="leaf2a" class="leaf grow" d="M26,-12 C36,-18 44,-10 36,-6 C30,-3 26,-6 26,-12" style="fill: rgb(47, 158, 62);"></path>
            <path id="leaf2b" class="leaf grow" d="M20,-12 C8,-18 0,-10 8,-6 C14,-3 18,-6 20,-12" style="fill: rgb(47, 158, 62);"></path>

            <g id="flower2" class="flower" transform="translate(26,-28)">
              <path class="flower-stem" d="M0,0 L0,12" stroke-linecap="round"></path>
              <g transform="translate(0,-2)">
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(0)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(45)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(90)"></ellipse>
                <ellipse class="petal" cx="0" cy="0" rx="6" ry="10" transform="rotate(135)"></ellipse>
                <circle class="center" cx="0" cy="0" r="4"></circle>
              </g>
            </g>
          </g>
        </g>

        <!-- decorative small insects/labels could go here -->
      </svg>

      <div class="footerNote">Poruka se pojavljuje iznad saksija. Kliknite saksiju da posadite seme, pa ponovo da posmatrate klijanje i rast.</div>
    </div>

    <div class="right-col">
      <div class="controls">
        <button id="waterBtn" class="tool" title="Zalivanje">üíß Zalivanje</button>
        <button id="resetBtn" class="tool" style="background:#ffadad;border-color:#ff8a8a">‚Ü∫ Resetuj vrt</button>
        <div class="note">Dugmad sa desne strane: zalivanje i reset.</div>
      </div>
    </div>
  </div>
</div>

<script>
  // Data-driven interactive behaviors for "Mini vrtlar" with flowers opening at sufficient growth
  (function(){
    const messagePanel = document.getElementById('messagePanel');
    const pots = Array.from(document.querySelectorAll('.pot'));
    const garden = document.getElementById('garden');
    const sunBtn = document.getElementById('sunBtn');
    const waterBtn = document.getElementById('waterBtn');
    const resetBtn = document.getElementById('resetBtn');
    const sunGroup = document.getElementById('sunGroup');
    const rays = Array.from(document.querySelectorAll('#rays .ray'));

    // Track clicks per object and growth levels per pot
    const potCounts = { pot0:0, pot1:0, pot2:0 };
    const growthLevels = { pot0:0, pot1:0, pot2:0 }; // 0..3 where 3 -> flower opens
    let waterCount = 0;
    let sunCount = 0;

    // Utility: set message text
    function setMessage(text){
      messagePanel.textContent = text;
    }

    // Flower open helper
    function openFlowerFor(index){
      const flower = document.getElementById('flower'+index);
      if(!flower) return;
      if(!flower.classList.contains('open')){
        flower.classList.add('open');
        // small pop effect on center
        const center = flower.querySelector('.center');
        if(center){
          center.style.transition = 'transform 300ms ease';
          center.style.transform = 'scale(0.85)';
          setTimeout(()=>{ center.style.transform = 'scale(1)'; }, 140);
        }
      }
    }

    function checkFlower(index){
      const potKey = 'pot'+index;
      if(growthLevels[potKey] >= 3){
        openFlowerFor(index);
      }
    }

    // Pot interaction handlers
    pots.forEach(function(pot){
      const id = pot.getAttribute('data-id');
      pot.addEventListener('click', function(){
        potCounts[id]++;
        const count = potCounts[id];
        const idx = id.replace('pot','');
        const seed = document.getElementById('seed'+idx);
        const sprout = document.getElementById('sprout'+idx);
        const leafA = document.getElementById('leaf'+idx+'a');
        const leafB = document.getElementById('leaf'+idx+'b');

        if(count === 1){
          // then_first: plant the seed -> show message and start small sprout animation
          setMessage('Seme posaƒëeno! Poƒçelo je klijanje.');
          // hide seed (slide down) and reveal sprout
          seed.style.transition = 'transform 700ms ease, opacity 600ms';
          seed.style.transform = 'translateY(6px) scale(0.6)';
          seed.style.opacity = '0.35';
          // initial growth level
          growthLevels[id] = 1;
          // animate sprout growth
          setTimeout(()=>{ sprout.classList.add('grow'); }, 150);
        } else {
          // then_next: add animation of small shoots and change text
          setMessage('Biljka raste, ali joj treba vi≈°e vode i svetla da procveta.');
          // reveal leaves
          setTimeout(()=>{ leafA.classList.add('grow'); leafB.classList.add('grow'); }, 150);
          // increase growth level up to 3
          growthLevels[id] = Math.min(3, (growthLevels[id] || 1) + 1);
          // adjust sprout visual to indicate taller plant
          const newStroke = 4 + growthLevels[id]*0.9;
          sprout.style.transition = 'stroke-width 600ms ease, transform 600ms ease';
          sprout.style.strokeWidth = newStroke;
          // slightly scale sprout vertically for "height"
          sprout.style.transform = 'scaleY(' + (1 + (growthLevels[id]-1)*0.12) + ')';
          // if reached threshold, open flower
          checkFlower(idx);
        }
      });
    });

    // Water button handler
    waterBtn.addEventListener('click', function(){
      waterCount++;
      if(waterCount === 1){
        setMessage('Biljke su zalivene.');
        // small visual: soil darker briefly for each pot
        pots.forEach((pot, i)=>{
          const soil = pot.querySelector('.soil');
          soil.style.transition = 'fill 600ms ease';
          soil.style.fill = '#4a2f21';
          setTimeout(()=>{ soil.style.fill = 'url(#soilGrad)'; }, 900);
        });
      } else {
        setMessage('Biljke brzo rastu, ali previ≈°e vode mo≈æe ih o≈°tetiti.');
        // create animated droplets falling over pots
        spawnDroplets();
        // make plants appear a bit larger if sprouts exist and increase growth
        pots.forEach((pot, i)=>{
          const spr = document.getElementById('sprout'+i);
          if(spr && spr.classList.contains('grow')){
            // gently enlarge leaves if present and increase growth slightly
            const lA = document.getElementById('leaf'+i+'a');
            const lB = document.getElementById('leaf'+i+'b');
            lA.classList.add('grow');
            lB.classList.add('grow');
            // slight transform taller
            spr.style.transform = 'scaleY(1.08)';
            setTimeout(()=>{ if(spr) spr.style.transform='scaleY(1)'; }, 700);
            // increase growth for this pot
            const key = 'pot'+i;
            growthLevels[key] = Math.min(3, (growthLevels[key] || 0) + 1);
            checkFlower(i);
          }
        });
      }
    });

    // Sunlight button handler
    sunBtn.addEventListener('click', function(){
      sunCount++;
      if(sunCount === 1){
        setMessage('Biljke dobijaju svetlost.');
        // small sun pulse
        sunGroup.classList.add('pulse');
      } else {
        setMessage('Biljke rastu zdravije, listovi postaju zeleniji.');
        // show rays animation
        rays.forEach((r, idx)=>{
          setTimeout(()=>{ r.classList.add('show'); }, idx * 80);
        });
        // make leaves greener / more visible and increase growth
        pots.forEach((pot,i)=>{
          const lA = document.getElementById('leaf'+i+'a');
          const lB = document.getElementById('leaf'+i+'b');
          if(lA && lB){
            lA.style.fill = '#2f9e3e';
            lB.style.fill = '#2f9e3e';
            lA.classList.add('grow'); lB.classList.add('grow');
            // increase growth for this pot
            const key = 'pot'+i;
            if((document.getElementById('sprout'+i) || {}).classList && document.getElementById('sprout'+i).classList.contains('grow')){
              growthLevels[key] = Math.min(3, (growthLevels[key] || 0) + 1);
              checkFlower(i);
            }
          }
        });
        // stop rays after a while
        setTimeout(()=>{ rays.forEach(r=>r.classList.remove('show')); }, 2200);
      }
    });

    // reset handler
    resetBtn.addEventListener('click', resetGarden);

    function resetGarden(){
      // reset counts
      Object.keys(potCounts).forEach(k => potCounts[k]=0);
      Object.keys(growthLevels).forEach(k => growthLevels[k]=0);
      waterCount = 0; sunCount = 0;
      setMessage('Vrt je resetovan. Kliknite na saksiju da posadite novo seme.');
      // revert visuals: seeds visible, sprouts hidden, leaves hidden, flowers closed
      pots.forEach((pot,i)=>{
        const seed = document.getElementById('seed'+i);
        const sprout = document.getElementById('sprout'+i);
        const leafA = document.getElementById('leaf'+i+'a');
        const leafB = document.getElementById('leaf'+i+'b');
        const flower = document.getElementById('flower'+i);
        // seed restore
        seed.style.transform = 'translateY(0) scale(1)';
        seed.style.opacity = '1';
        // sprout hide
        sprout.classList.remove('grow');
        sprout.style.strokeWidth = '4';
        sprout.style.transform = 'scaleY(1)';
        // leaves hide & color reset
        leafA.classList.remove('grow'); leafB.classList.remove('grow');
        leafA.style.fill = '#2b8b3b'; leafB.style.fill = '#2b8b3b';
        // soil color reset
        const soil = pot.querySelector('.soil');
        soil.style.fill = 'url(#soilGrad)';
        // close flower
        if(flower) flower.classList.remove('open');
      });
      // sun/rays off
      sunGroup.classList.remove('pulse');
      rays.forEach(r=>r.classList.remove('show'));
      // remove any lingering droplets
      const drops = Array.from(document.querySelectorAll('.droplet'));
      drops.forEach(d=>d.remove());
    }

    // create droplet animations over each pot
    function spawnDroplets(){
      // create a few droplets over each pot area and animate using CSS keyframes via JS
      pots.forEach((pot, idx)=>{
        const transform = pot.getAttribute('transform'); // "translate(x,y)"
        const match = /translate\(([-\d.]+),\s*([-\d.]+)\)/.exec(transform);
        let tx = 0, ty = 0;
        if(match){ tx = parseFloat(match[1]); ty = parseFloat(match[2]); }
        // spawn 3 droplets with slight offsets
        for(let i=0;i<3;i++){
          const cx = tx + 10 + i*8 + (Math.random()*8-4);
          const cy = ty - 20 + (Math.random()*6-3);
          createDroplet(cx, cy, idx);
        }
      });
    }

    function createDroplet(x,y,potIndex){
      // droplet is an SVG circle appended to garden
      const svgns = "http://www.w3.org/2000/svg";
      const c = document.createElementNS(svgns,'circle');
      c.setAttribute('class','droplet');
      c.setAttribute('r','6');
      c.setAttribute('cx', x);
      c.setAttribute('cy', y);
      garden.appendChild(c);
      // animate via transitions (falling + fade)
      const fallDist = 40 + Math.random()*30;
      c.style.transition = `transform 900ms cubic-bezier(.25,.9,.35,1), opacity 900ms ease`;
      // translate by fallDist
      requestAnimationFrame(()=>{
        c.style.transform = `translate(0,${fallDist}px)`;
        c.style.opacity = '0.1';
      });
      // after animation remove and create ripple (soil hit)
      setTimeout(()=>{
        // create tiny splash (ellipse)
        const splash = document.createElementNS(svgns,'ellipse');
        splash.setAttribute('cx', x);
        splash.setAttribute('cy', y + fallDist - 6);
        splash.setAttribute('rx', 1);
        splash.setAttribute('ry', 0.6);
        splash.setAttribute('fill','#89d0ff');
        splash.style.opacity='0.95';
        splash.style.transition='opacity 700ms ease, rx 700ms ease';
        garden.appendChild(splash);
        setTimeout(()=>{ splash.setAttribute('rx','8'); splash.style.opacity='0'; },20);
        // cleanup
        setTimeout(()=>{ c.remove(); splash.remove(); }, 780);
      }, 920);
    }

    // accessibility: allow clicking the sun graphic to also toggle sunlight interactions
    document.getElementById('sunGroup').addEventListener('click', ()=> sunBtn.click());

    // Allow pressing W for water, S for sun, R for reset (keyboard)
    window.addEventListener('keydown', function(e){
      if(e.key === 'w' || e.key === 'W'){ waterBtn.click(); }
      if(e.key === 's' || e.key === 'S'){ sunBtn.click(); }
      if(e.key === 'r' || e.key === 'R'){ resetBtn.click(); }
    });

    // initial minor entrance animation: tiny bounce for seeds to indicate interactivity
    setTimeout(()=> {
      pots.forEach((pot,i)=>{
        const seed = document.getElementById('seed'+i);
        seed.style.transition = 'transform 500ms cubic-bezier(.2,.9,.2,1)';
        seed.style.transform = 'translateY(-6px)';
        setTimeout(()=>{ seed.style.transform = 'translateY(0)'; }, 400 + i*80);
      });
    }, 400);

  })();
</script>

</body></html>